//search_funcs_3.94.min.js//
function FXautoComplete(params){function boldSymbol(a,b,c){var d=a.replace(/[-\/\\^$*+?.()|[\]{}]/g,""),e=d.toUpperCase(),f=new RegExp("("+d+")","gi"),g=c?e:"$1";return b.replace(f,'<i class="bold">'+g+"</i>")}var _that=this,$ajax=null,params=params||{};$prefix=params.$prefix||"",$newSearchWidget=params.$newSearchWidget||!1,$searchtype=params.$searchtype||"",$resultType=params.$resultType||"",$AllCountries=params.$AllCountries||"",$tabsinfo=params.$tabsinfo||"",$functionName=params.$functionName||"",$paramList=params.$paramList||"",$no_search_results=params.$no_search_results||"",this.params=params,this.Element={minimumChar:1,hasTabs:!1,selectedCountryId:0,hasDefaultText:!0,googleSearchDefineId:"googleLinkSearchTop"};var _element={newSearchWidget:$newSearchWidget,searchTextInputId:"searchText_"+$prefix,resultsInnerContainerId:"searchTopResults_"+$prefix,resultsOuterContainerId:"subContainer_"+$prefix,formElementId:"combineSearchForm_"+$prefix,hasTabs:!0,trackSearches:!1,tabsContainerId:"search_tabs_"+$prefix,tabsType:"li",searchType:$searchtype,resultType:$resultType,portfolioPairId:0,tabsDivId:"searchBoxTabsTopTabs_"+$prefix,countriesType:"td",dynamicVar:$prefix,url:"/search/service/search",mainResultRowIdPrefix:"searchRowIdtop_",tabsPrefix:"search_box_top_"+$prefix,countryRowPrefix:"tdCountry_"+$prefix,countriesWrapperId:"countries_wrapper_"+$prefix,countriesTableId:"countries_table_"+$prefix,countriesDefaultText:$AllCountries,hiddenNoResultsDefine:"noResultsDefinesearchTopResults_"+$prefix,hiddenDocDirectionId:"doc_directionsearchTopResults_"+$prefix,loadOnTabChange:!1,loadingMessage:'<table><tbody><tr id="no_results"><td class="align_center noResults"><span class="loading">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr></tbody></table>'};$.extend(!0,this.Element,_element),this.rowNumber=0,this.lastRowNumber=1,this.searchText="",this.allowdReset=!0,this.allowdClosePopUp=!0,this.allowdKeys=!1,this.allowdForm=!1,this.searchTimeOutRunning=!1,this.arrowfocus="",this.current_tab="All",this.previousTab="All",this.resultsData="",this.firstRowId=0,this.dynamicVar="",this.countriesData=void 0,this.countriesDefaultText=void 0,this.searchType="",this.portfolioPairId=void 0,this.resultType=void 0;var searchTracking=new function(a){var b={};return this.sendTrackingInfo=function(c){if(a.trackSearches){var d="/search/service/LogSearch";b.searchString&&0!==$.trim(b.searchString).length&&b.clickedResult&&!isNaN(b.clickedResult)&&($.ajax({url:d,data:b,dataType:"json",type:"POST",success:function(){c()},error:function(){c()}}),console.log(b))}},this.setSearchedString=function(c){a.trackSearches&&(b.searchString=c)},this.setClickedResult=function(c){a.trackSearches&&(b.clickedResult=c)},this}(this.Element);this.setTabsText=function(a){a&&""!=a||(a='[{"id":"search_box_topAll","name":"All","select":true},{"id":"search_box_topIndices","name":"Indices","select":false},{"id":"search_box_topStocks","name":"Stocks","select":false},{"id":"search_box_topETFs","name":"ETFs","select":false},{"id":"search_box_topCommodities","name":"Commodities","select":false},{"id":"search_box_topForex","name":"Forex","select":false},{"id":"search_box_topBonds","name":"Bonds","select":false},{"id":"search_box_topCountries","name":"All Countries","select":false}]');var b=JSON.parse(a),c="",d=0;for(tab_id in b){var e=1==b[tab_id].selected?"selected":"",f=0==d?"first":"",g=d==b.length-1?"last":"",h="search_box_topCountries"==b[tab_id].id||-1!==b[tab_id].id.indexOf("Countries")?"country":"";"search_box_topCountries"==b[tab_id].id&&(this.countriesDefaultText=b[tab_id].name),c+='<li id="'+b[tab_id].id+'" class="'+f+" "+g+" "+h+" "+e+'"><a href="javascript:void(0);">'+b[tab_id].name+"</a></li>",d++}$("#"+this.Element.tabsDivId).html(c)},this.clearInputField=function(a){""==this.searchDeafaultVale&&(this.searchDeafaultVale=$(a).val());var b=this.searchDeafaultVale;""!=$(a).attr("default")&&(b=$(a).attr("default")),b==$(a).val()&&($("#"+this.Element.searchTextInputId).val(""),this.allowdReset=!0,this.allowdKeys=!1,this.allowdForm=!1)},this.markSelectedRow=function(){$("#"+this.Element.resultsInnerContainerId+" .row").removeClass("hoverSearch"),$("#"+this.Element.mainResultRowIdPrefix+this.rowNumber).addClass("hoverSearch")},this.setSelectedRowNumber=function(a){this.allowdForm=!0,this.lastRowNumber=this.rowNumber,this.rowNumber=a},this.changeCurrentTabDisplay=function(a){$("#"+this.Element.tabsPrefix+a).addClass("selected"),$("#"+this.Element.tabsPrefix+a).siblings().each(function(){$(this).removeClass("selected")})},this.getSelectedRowElement=function(a){return $("#"+a.Element.mainResultRowIdPrefix+this.rowNumber)},this.closeAutocomplete=function(a){a.Element.selectedCountryId=0,this.previousTab="All",$("#"+this.Element.resultsInnerContainerId).scrollTop(0),$("#"+this.Element.countriesScrollDiv).scrollTop(0),$("#"+a.Element.countriesWrapperId).addClass("displayNone");var b=this.countriesDefaultText;void 0==this.countriesDefaultText&&(b=this.Element.countriesDefaultText),$("#"+a.Element.tabsPrefix+"Countries").html('<a href="javascript:void(0);">'+b+"</a>"),$("#"+a.Element.resultsOuterContainerId).addClass("displayNone"),$("#"+a.Element.resultsInnerContainerId).html("")},this.closeSearchResultBox=function(){$("#"+this.Element.resultsOuterContainerId).addClass("displayNone"),this.closeAutocomplete.call(this,this)},this.getResultsNumber=function(){return $("#"+this.Element.resultsInnerContainerId).find("table tr").length},this.keyCodeUp=function(){this.rowNumber--;var a=this.getResultsNumber.call(this);(-1==this.rowNumber||isNaN(this.rowNumber))&&($("#"+this.Element.resultsInnerContainerId+" .row").removeClass("hoverSearch"),$("#"+this.Element.formElementId).attr("onsubmit","return false;"),this.arrowfocus="text",$("#"+this.Element.searchTextInputId).focus(),this.rowNumber=-1,$("#"+this.Element.searchTextInputId).val(this.searchText),this.allowdKeys=!0),a-this.rowNumber>7&&$("#"+this.Element.resultsInnerContainerId).scrollTop($("#"+this.Element.resultsInnerContainerId).scrollTop()-22)},this.keyCodeDown=function(){void 0===this.rowNumber&&(this.rowNumber=0),this.arrowfocus="tabs";var a=this.getResultsNumber.call(this);a!=this.rowNumber&&($("#"+this.Element.formElementId).attr("onsubmit","return true;"),this.rowNumber++,this.rowNumber>7?$("#"+this.Element.resultsInnerContainerId).scrollTop($("#"+this.Element.resultsInnerContainerId).scrollTop()+22):$("#"+this.Element.resultsInnerContainerId).scrollTop(0))},this.keyFunctunality=function(a,b){this.allowdForm=!1,this.lastRowNumber=this.rowNumber;var c=!0;if(40==b)this.keyCodeDown.call(this);else if(38==b)this.keyCodeUp.call(this);else if(39==b&&"tabs"==this.arrowfocus&&this.Element.hasTabs){var d=this.getTheNextTab.call(this,1);""==d?c=!1:this.rowNumber=0,this.ChangeTabOnClick.call(this,d)}else if(37==b&&"tabs"==this.arrowfocus&&this.Element.hasTabs){var d=this.getTheNextTab.call(this,0);""==d?c=!1:this.rowNumber=0,this.ChangeTabOnClick.call(this,d)}var e=this.getSelectedRowElement(this);if(e.length>0&&c){var f=this.executeGetSymbol.call(this,e);this.symbolAndAction.call(this,f,e,$("#"+this.Element.searchTextInputId),!1),this.markSelectedRow.call(this)}},this.setGoogleLink=function(){var a=_that.Element.googleSearchDefineId,b="/"+a+"?q="+window.encodeURIComponent(_that.searchText);$("#"+_that.Element.googleLinkID).attr("href",b),$("#"+_that.Element.googleLinkID).text(_that.searchText)},this.symbolAndAction=function(a,b,c,d){a=a.replace(/<\/\i>/g,""),a=a.replace(/<i class="bold">/g,""),a=a.replace(/<\/\I>/g,""),a=a.replace(/<I class=bold>/g,""),a=a.replace(/<\/\i>/g,""),a=a.replace(/<\/\i>/g,""),1!=d&&$(c).val(a),void 0!=this.Element.formElementId&&""!=this.Element.formElementId&&($("#"+this.Element.formElementId).attr("action",$("#"+b.attr("id")+" .symbolName").attr("link")),"portfolio"==this.Element.searchType&&(this.Element.portfolioPairId=$("#"+b.attr("id")+" .symbolName").attr("pairid")))},this.displayAndSetSearchResultBox=function(){if(this.allowdForm=!0,this.arrowfocus="tabs","no_results"===this.firstRowId&&""!=this.Element.googleSearchDefineId){this.allowdForm=!0;var a=this.Element.googleSearchDefineId;$("#"+this.Element.formElementId).attr("action","/"+a+"?q="+this.searchText),$("#"+this.Element.formElementId).attr("onsubmit","return true;")}else"no_results"===this.firstRowId?(this.allowdForm=!1,$("#"+this.Element.formElementId).attr("onsubmit","return false;")):$("#"+this.Element.formElementId).attr("onsubmit","return this.allowdForm;");$("#"+this.Element.formElementId).attr("action",$("#"+this.Element.mainResultRowIdPrefix+this.firstRowId+" .symbolName").attr("link")),this.Element.portfolioPairId=$("#"+this.Element.mainResultRowIdPrefix+this.firstRowId+" .symbolName").attr("pairid");this.Element.hasTabs&&this.bindTabs(),this.executeBindResults(),$("#"+this.Element.resultsOuterContainerId).removeClass("displayNone")},this.validateForSearch=function(a,b){38!=a.keyCode&&40!=a.keyCode&&37!=a.keyCode&&39!=a.keyCode&&(this.searchText=$(b).val().replace(/<.*>/gi,"")),this.searchText.length>0&&(38==a.keyCode||40==a.keyCode||37==a.keyCode||39==a.keyCode)&&this.allowdKeys?this.keyFunctunality.call(this,a,a.keyCode):13!=a.keyCode&&this.searchText.length>=this.Element.minimumChar&&!this.searchTimeOutRunning?(this.allowdReset=!1,this.checkIfTimedOut.call(this)):0==this.searchText.length&&this.closeSearchResultBox.call(this)},this.checkIfTimedOut=function(){var a=this;this.searchTimeOutRunning||(this.searchTimeOutRunning=!0,clearTimeout(a.timer),a.timer=setTimeout(function(){a.executeAutoCompleteSearch()},400))},this.executeAutoCompleteSearch=function(){var a=this,b=a.Element.url,c=a.Element.loadOnTabChange||!1,d={};if(""==a.searchText)return void(a.searchTimeOutRunning=!1);"undefined"!=typeof a.Element.resultType&&a.Element.resultType.length>0&&(b+="?searchType="+a.Element.resultType);var e=$("#"+this.Element.formElementId+" > .searchGlassIcon, #"+this.Element.formElementId+" > .loading");e.removeClass("searchGlassIcon newSiteIconsSprite").addClass("loading"),this.allowdForm=!1,(""==a.Element.selectedCountryId||isNaN(parseInt(a.Element.selectedCountryId)))&&(a.Element.selectedCountryId=0),""!=a.Element.googleSearchDefineId&&a.setGoogleLink.call(),d={search_text:a.searchText,term:a.searchText,country_id:a.Element.selectedCountryId},c&&(d.tab_id=this.previousTab),a.xhr&&a.xhr.abort(),searchTracking.setSearchedString(a.searchText),$ajax=a.xhr=$.post(b,d,function(b){return a.allowdKeys=!1,a.allowdForm=!1,a.resultsData=b,a.xhr=null,""==b||null==b?(a.closeSearchResultBox(),e.removeClass("loading"),void e.addClass("searchGlassIcon newSiteIconsSprite")):(a.allowdKeys=!0,a.arrowfocus="text",a.executeBuildResultsBox(),a.displayAndSetSearchResultBox(),e.removeClass("loading"),void e.addClass("searchGlassIcon newSiteIconsSprite"))},"json"),this.searchTimeOutRunning=!1},this.inputFieldBind=function(a){var b=this;a.unbind("focus").bind("focus",function(){b.clearInputField.call(b,a),$("#"+this.id+"Container").addClass("topBarInputSelected"),b.rowNumber=0}),a.unbind("keydown").bind("keydown",function(a){13==a.which&&$("#"+b.Element.resultsInnerContainerId+" table>tbody>tr.hoverSearch").click()}),a.unbind("keyup").bind("keyup",function(c){b.allowdKeys=!0,b.validateForSearch.call(b,c,a)}),$("#"+b.Element.searchTextInputId).focus(function(a){$(this).attr("prevValue",$(this).val())}),$("#"+b.Element.searchTextInputId).click(function(a){$ajax&&$ajax.abort(),$("#combineSearchForm_rowid > span").removeClass("loading"),$(this).keyup()}),$("#"+b.Element.searchTextInputId).unbind("mouseenter").bind("mouseenter",function(){$("#combineSearchForm_rowid>span").addClass("searchGlassIcon newSiteIconsSprite")}),$("#"+b.Element.searchTextInputId).unbind("mouseout").bind("mouseout",function(){$("#combineSearchForm_rowid>span").removeClass("searchGlassIcon newSiteIconsSprite")}),$("#"+b.Element.searchTextInputId).unbind("focusout").bind("focusout",function(a){$("#combineSearchForm_rowid>span").removeClass("searchGlassIcon newSiteIconsSprite"),$(document).unbind("click.outsideSearch").on("click.outsideSearch",function(a){$(a.target).parents("#"+b.Element.resultsInnerContainerId).length<1&&a.target.id!=b.Element.resultsInnerContainerId&&$(a.target).parents("#"+b.Element.searchTextInputId).length<1&&a.target.id!=b.Element.searchTextInputId&&$(a.target).parents("#"+b.Element.resultsOuterContainerId).length<1&&a.target.id!=b.Element.resultsOuterContainerId&&(b.Element.newSearchWidget||(b.Element.hasDefaultText?""!=$("#"+b.Element.searchTextInputId).attr("prevValue")?$("#"+b.Element.searchTextInputId).val($("#"+b.Element.searchTextInputId).attr("prevValue")):$("#"+b.Element.searchTextInputId).val(this.searchDeafaultVale):$("#"+b.Element.searchTextInputId).val("")),$("#"+b.Element.searchTextInputId+"Container").removeClass("topBarInputSelected"),0==$(a.target).closest(".subContainer_rowid").length&&0==$(a.target).closest("#combineSearchForm_rowid").length&&$(a.target).parents("html").length>0&&($ajax&&$ajax.abort(),$("#combineSearchForm_rowid > span").removeClass("loading"),""!=$("#"+b.Element.searchTextInputId).attr("prevValue")&&$("#"+b.Element.searchTextInputId).val($("#"+b.Element.searchTextInputId).attr("prevValue"))),b.closeAutocomplete(b))})})},this.getTabLoadingMessage=function(){$("#"+this.Element.resultsInnerContainerId).html(this.Element.loadingMessage)},this.ChangeTabOnClick=function(a){a=a.replace(this.Element.tabsPrefix,"");var b=this,c=!0;""==a&&(c=!1,a=this.previousTab),"Countries"!=a?(this.previousTab=a,c&&(this.Element.loadOnTabChange?(this.executeAutoCompleteSearch.call(this),b.changeCurrentTabDisplay(this.previousTab),this.getTabLoadingMessage.call(this)):this.executeBuildResultsBox.call(this)),this.displayAndSetSearchResultBox.call(this),"tabs"!=this.arrowfocus&&($("#"+this.Element.formElementId).attr("onsubmit","return false;"),this.arrowfocus="text"),c&&($("#"+this.Element.searchTextInputId).focus(),setTimeout(function(){$("#"+b.Element.searchTextInputId).val(b.searchText)},1))):"Countries"==a&&($("#"+b.Element.countriesWrapperId).hasClass("displayNone")?($ajax=$.ajax({url:"/search/countries",dataType:"json",async:!1,success:function(a){FXautoComplete.countriesData=a;var c="";for(var d in a){var e="true"==a[d].selected?"selected":"";c+="",c+='<tr id="country'+b.Element.dynamicVar+"_"+a[d].country_id+'">',c+='<td class="'+e+'" id="tdCountry'+b.Element.dynamicVar+"_"+a[d].country_id+'">'+a[d].country_name+"</td>",c+="</tr>"}$("#"+b.Element.countriesTableId+" > tbody").html(c)}}),this.bindCountries(),$("#"+b.Element.countriesWrapperId).removeClass("displayNone")):$("#"+b.Element.countriesWrapperId).addClass("displayNone"))},this.bindCountries=function(){var a=this;$("#"+a.Element.countriesTableId+" "+a.Element.countriesType).each(function(){a.Element.countryRowPrefix+a.Element.selectedCountryId!=this.id&&$(this).removeClass("selected"),$(this).unbind(),$(this).click(function(){a.searchInCountryId.call(a,this.id)})})},this.searchInCountryId=function(a){$("#"+a).addClass("selected"),this.Element.selectedCountryId=a.replace(/^\D+/g,""),this.allowdReset=!1,$("#"+this.Element.countriesScrollDiv).scrollTop(0),$("#"+this.Element.countriesWrapperId).addClass("displayNone"),this.checkIfTimedOut.call(this),$("#"+this.Element.tabsPrefix+"Countries").html('<a href="javascript:void(0);">'+$("#"+a).html()+"</a>"),$("#"+this.Element.searchTextInputId).focus(),setTimeout(function(){$("#"+this.Element.searchTextInputId).val(this.searchText)},1)},this.bindTabs=function(){var a=this;$("#"+a.Element.tabsDivId+" "+a.Element.tabsType).each(function(){$(this).unbind(),$(this).click(function(){a.ChangeTabOnClick.call(a,this.id)})})},this.getTheNextTab=function(a){"rtl"==$("#"+this.Element.hiddenDocDirectionId).attr("rel")&&(a=0==a?1:0);var b=this,c=new Array,d="",e="",f=0;$("#"+b.Element.tabsDivId+" "+b.Element.tabsType).each(function(){d=this.id,e=d.replace(b.Element.tabsPrefix,""),c[f]=e,f++});for(var g="",h=0;h<c.length;h++)this.previousTab==c[h]&&(0==a&&(a=-1),g=c[h+a]);return g=""!=g&&void 0!=g&&"Countries"!=g?b.Element.tabsPrefix+g:""},this.executeBuildResultsBox=function(){var a=this,b=this.resultsData;a.buildSearchResults(b)},this.executeBindResults=function(){var a=this;$("#"+a.Element.resultsInnerContainerId+" .row").each(function(){$(this).unbind(),a.bindResults(this)})},this.executeGetSymbol=function(a){return this.getSymbol(a)},this.setTabsText($tabsinfo),this.inputFieldBind($("#searchText_"+$prefix)),this.getSymbol=function(a){return $("#"+a.attr("id")+" .symbolName").html()},this.actionMouseMoveOnRow=function(a,b,c){var d=$(a).attr("id"),e=d.substr(d.indexOf("_")+1);c.setSelectedRowNumber.call(b,e),c.markSelectedRow.call(b,b),c.symbolAndAction.call(b,$("#"+d+" .symbolName").html(),c.getSelectedRowElement(b),$("#"+b.Element.searchTextInputId),!0)};var _that=this;$("#"+this.Element.formElementId).unbind("submit").submit(function(){var result=new Object,selected=_that.resultsData.All[_that.rowNumber];if(_that.trackSearch(),result.pairId=selected.pair_ID,result.symbol=selected.symbol,result.name=selected.trans_name,result.stock=selected.exchange_name_short,result.country=selected.country_ID,result.pairtypelabel=selected.pair_type_label,""!=$functionName){var func=eval($functionName);func(result)}return $("#search_loading_"+$prefix).hide(),_that.closeSearchResultBox(),!1}),this.trackSearch=function(a){var b=this,c=a||function(){},d=b.resultsData.All[b.rowNumber];searchTracking.setClickedResult(d.pair_ID),searchTracking.sendTrackingInfo(c)},this.bindResults=function(rowElement){var that=this;$(rowElement).mousemove(function(){that.actionMouseMoveOnRow(rowElement,that,that)}).click(function(){var result=new Object,selected=that.resultsData.All[that.rowNumber];if(""!=that.params.$functionName){var func=eval(that.params.$functionName);selected.extraParam=that.params.$paramList,func(selected)}$("#search_loading_"+$prefix).hide(),that.closeSearchResultBox()})},this.buildSearchResults=function(a){var b=this,c="",d=b.previousTab;b.changeCurrentTabDisplay(d),b.firstRowId=0;var e="",f=0;return a.All[0]!==b.params.$no_search_results&&$.each(a.All,function(a,g){$("tr[rel="+$prefix+"_"+g.pair_ID+"]").length||void 0!==g&&(g.tab_ID&&g.tab_ID.toLowerCase()==d.toLowerCase()||"All"==d)&&(e=boldSymbol(b.searchText,g.symbol),c+=b.searchText.toLowerCase()===g.symbol.toLowerCase()&&0==f?'<table><tbody><tr data-pair-id="'+g.pair_ID+'"  class="row selectedRowExactMatch hoverSearch"  id="'+b.Element.mainResultRowIdPrefix+a+'">':0==f?'<table><tbody><tr data-pair-id="'+g.pair_ID+'"  class="row hoverSearch"  id="'+b.Element.mainResultRowIdPrefix+a+'">':'<tr class="row" data-pair-id="'+g.pair_ID+'"  id="'+b.Element.mainResultRowIdPrefix+a+'">',f++,c+='<td class="first symbolName" pairid="'+g.pair_ID+'" id="symbol_'+g.symbol+'" link="'+g.link+'">'+e+'</td><td class="second" class="dirLtr">'+g.name+"</td>",c+='<td class="third typeExchange arial_11 text_align_lang_base_2 dir_lang_base_1" pairid="'+g.pair_ID+'" id="type_'+g.pair_ID+'" link="'+g.link+'">'+g.pair_type_label,("Equities"==g.pair_type||"indice"==g.pair_type||"etf"==g.pair_type||g.exchange_name_short)&&(c+=" - "+g.exchange_name_short),c+="</td></tr>")}),0==f?(c='<table><tbody><tr id="no_results"><td class="align_center noResults">'+b.params.$no_search_results+"</td></tr></tbody></table>",b.arrowfocus="tabs",b.firstRowId="no_results",void $("#"+b.Element.resultsInnerContainerId).html(c)):(c+="</tbody></table>",void $("#"+b.Element.resultsInnerContainerId).html(c))},this.boldSymbol=boldSymbol}